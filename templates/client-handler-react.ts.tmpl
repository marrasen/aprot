// Code generated by aprot. DO NOT EDIT.
// Handler: {{.StructName}}

{{- if .Methods}}
import { useCallback } from 'react';
{{- end}}
import { ApiClient{{if .Methods}}, useQuery, useMutation{{end}}{{if .PushEvents}}, usePushEvent{{end}} } from './client';
{{- if or .Methods .PushEvents .BaseTypeImports}}
import type {
{{- if .Methods}}
    RequestOptions,
    UseQueryOptions,
    UseQueryResult,
    UseMutationOptions,
    UseMutationResult,
{{- end}}
{{- if .PushEvents}}
    PushHandler,
    UsePushResult,
{{- end}}
{{- range .BaseTypeImports}}
    {{.}},
{{- end}}
} from './client';
{{- end}}

{{range .Enums -}}
export const {{.Name}} = {
{{- range .Values}}
    {{.Name}}: {{.Value}},
{{- end}}
} as const;
export type {{.Name}}Type = typeof {{.Name}}[keyof typeof {{.Name}}];

{{end -}}
{{range .Interfaces -}}
export interface {{.Name}} {
{{- range .Fields}}
    {{.Name}}{{if .Optional}}?{{end}}: {{.Type}};
{{- end}}
}

{{end -}}
{{range .Methods -}}
export function {{.MethodName}}(client: ApiClient{{if hasParams .Params}}, {{paramDecl .Params}}{{end}}, options?: RequestOptions): Promise<{{.ResponseType}}> {
    return client.request<{{.ResponseType}}>('{{.WireMethod}}', [{{paramArray .Params}}], options);
}

{{end -}}
{{range .PushEvents -}}
export function {{.HandlerName}}(client: ApiClient, handler: PushHandler<{{.DataType}}>): () => void {
    return client.onPush<{{.DataType}}>('{{.Name}}', handler);
}

{{end -}}
// React Hooks for {{.StructName}}
{{range .Methods}}
{{- if not (hasParams .Params)}}
export function {{.HookName}}(options?: UseQueryOptions): UseQueryResult<{{.ResponseType}}> {
    return useQuery({{.MethodName}}, options);
}

export function {{.HookName}}Mutation(options?: UseMutationOptions): UseMutationResult<[], {{.ResponseType}}> {
    const wrappedFn = useCallback(
        (client: ApiClient, signal: AbortSignal) => {{.MethodName}}(client, { signal, onProgress: options?.onProgress }),
        [options?.onProgress],
    );
    return useMutation(wrappedFn, options);
}
{{- else}}
export function {{.HookName}}({{paramDecl .Params}}, options?: UseQueryOptions): UseQueryResult<{{.ResponseType}}> {
    return useQuery({{.MethodName}}, { ...options, params: [{{paramNames .Params}}] });
}

export function {{.HookName}}Mutation(options?: UseMutationOptions): UseMutationResult<[{{paramDecl .Params}}], {{.ResponseType}}> {
    const wrappedFn = useCallback(
        (client: ApiClient, signal: AbortSignal, {{paramDecl .Params}}) => {{.MethodName}}(client, {{paramNames .Params}}, { signal, onProgress: options?.onProgress }),
        [options?.onProgress],
    );
    return useMutation(wrappedFn, options);
}
{{- end}}
{{end}}
{{- range .PushEvents}}
export function {{.HookName}}(options?: { maxEvents?: number }): UsePushResult<{{.DataType}}> {
    return usePushEvent({{.HandlerName}}, options);
}
{{end -}}
